<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!-- jquery cdn -->
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="style.css">

    <title>코코리 색채테스트</title>
</head>

<body>
    <div id="navbar">

    </div>
    <main id="test-app">

        <article id="main-page">

        </article>

        <article id="before-hue-test">

        </article>

        <article id="hue-test-1" style="display: block;">
            <button class="action-begin">test start</button>
            <p class="text-center">색상테스트</p>
            <p class="text-center">색상을 부드럽게 이어주세요</p>
            <p class="text-center timer">0초</p>
            <canvas id="wheel-20"></canvas>
            <div class="container action-menu">
                <div class="row justify-content-center">
                    <div class="col-8"><button class="action-option">전체보기</button></div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-4"><button class="action-option">reset</button></div>
                    <div class="col-4"><button class="action-option action-submit">submit</button></div>
                </div>
            </div>
        </article>

        <article id="result-hue-1">

        </article>
    </main>

    <script src="game_dataset.js"></script>
    <script src="hue_test.js"></script>
    <script type="text/javascript">
        /****important params****/
        const SCORE_RATE_FOR_UNDERTIME = 0.7;

        /****************************game action buttons****************************/
        // scoreing
        let totScore = 0;

        // class = "next-button"
        $('.action-next').click(function() {
            clicked_article = $(this).closest("article");
            clicked_article.fadeOut(500);
            clicked_article.next().fadeIn(700);
        });

        // class = "timer" : showing how long has been taken
        // class = "test-begin" : button to start down-count time
        let downTime;
        let upTime;
        let timer;
        $('.action-begin').click(function() {
            downTime = GAMEINFO.timeLimit + 1;
            upTime = 0;
            document.querySelector(".timer").innerHTML = downTime + "초";
            timer = setInterval(function() {
                downTime--;
                upTime++;
                document.querySelector(".timer").innerHTML = downTime + "초";
                if (downTime <= 0) {
                    clearInterval(timer);
                    submit()
                };
            }, 1000);
        });

        // submit
        $(document).on("click", "button.action-submit", function() {
            submit();
        });

        function submit() {
            console.log("!");
            if (GAMEINFO.selectedArr == GAMEINFO.answerArr) {
                totScore += downTime * SCORE_RATE_FOR_UNDERTIME;
            } else {
                // 틀린 부분을 알려주기
            }
            downTime = 0;
        }

        /********************************************************/

        // color Decimal code 2 "#Hex" code
        function ColorD2X(dec) {
            return '#' + ("00" + dec.toString(16)).slice(-6);
        };

        // compute distance
        function dist(x0, y0, x1, y1) {
            return Math.sqrt(Math.abs((x0 - x1) * (x0 - x1)) + Math.abs((y0 - y1) * (y0 - y1)));
        }

        const PI2 = Math.PI * 2;

        window.onload = () => {
            new HueGame(document.querySelector("#wheel-20"), 10);
        }
    </script>
</body>

</html>